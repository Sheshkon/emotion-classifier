# emotion-classifier

# Структура
Основой тестового задания является решение некоторой целевой задачи (например задачи классификации/регрессии/сегментации).

Разработка проекта может состоять из двух частей:

1) Подготовка инструментов решения целевой задачи. Как правило, это обучение искусственной нейронной сети, включающее следующие этапы: подготовка/валидация данных для обучения, выбор и обоснование подходящего инструмента (архитектура модели искусственной нейронной сети), обучение модели (baseline), корректировка данных и модели для увеличения точности ([аугментация](https://neerc.ifmo.ru/wiki/index.php?title=%D0%9F%D1%80%D0%B0%D0%BA%D1%82%D0%B8%D0%BA%D0%B8_%D1%80%D0%B5%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8_%D0%BD%D0%B5%D0%B9%D1%80%D0%BE%D0%BD%D0%BD%D1%8B%D1%85_%D1%81%D0%B5%D1%82%D0%B5%D0%B9#:~:text=%D0%90%D1%83%D0%B3%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%20\(%D0%B0%D0%BD%D0%B3%D0%BB.,%D0%B7%D0%B0%D0%B4%D0%B0%D1%87%2C%20%D1%81%D0%B2%D1%8F%D0%B7%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%20%D1%81%20%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%BE%D0%B9%20%D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9.) данных для обучения, подбор параметров модели, использование пред обученных весов и т.п.). В зависимости от целевой задачи могут использоваться альтернативные подходы (алгоритмы классического computer vision, boosting алгоритмы и т.п.);
2) Реализация веб-приложения (или десктопного приложения) для демонстрации работы полученных инструментов решения целевой задачи.
# Целевые задачи
### Классификация эмоций
**Цель**: подготовить модели для классификации эмоций лица, оценить качество их работы,

предложить варианты улучшения качества работы.

[**Данные**:](https://drive.google.com/file/d/1b_IdRm6pp0WmsofaG3dLGPrF08vRseu2/view?usp=sharing)

The data consists of 48x48 pixel grayscale images of faces. The faces have been automatically registered so that the face is more or less centered and occupies about the same amount of space in each image. The task is to categorize each face based on the emotion shown in the facial expression in to one of seven categories (0=Angry, 1=Disgust, 2=Fear, 3=Happy, 4=Sad, 5=Surprise, 6=Neutral).

train.csv contains two columns, "emotion" and "pixels". The "emotion" column contains a numeric code ranging from 0 to 6, inclusive, for the emotion that is present in the image. The "pixels" column contains a string surrounded in quotes for each image. The contents of this string a space-separated pixel values in row major order. test.csv contains only the "pixels" column and your task is to predict the emotion column.

The training set consists of 28,709 examples. The public test set used for the leaderboard consists of 3,589 examples. The final test set, which was used to determine the winner of the competition, consists of another 3,589 examples.


**Задачи**:

1. Исследовать текущие актуальные модели по данной задаче.

2. Распарсить данные в удобный для обучения вид. Данные разбить на трэин и тест.

Данные предварительно аугментировать керас/пайторч генератором или вручную.

(выбор обосновать)

3. Обучить классификатор с [бэкбон](https://habr.com/ru/post/510560/#:~:text=Backbone%20%E2%80%93%20%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D0%B0%D1%8F%20\(%D0%B1%D0%B0%D0%B7%D0%BE%D0%B2%D0%B0%D1%8F\)%20%D1%81%D0%B5%D1%82%D1%8C%2C%20%D1%81%D0%BB%D1%83%D0%B6%D0%B0%D1%89%D0%B0%D1%8F%20%D0%B4%D0%BB%D1%8F%20%D0%B8%D0%B7%D0%B2%D0%BB%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BF%D1%80%D0%B8%D0%B7%D0%BD%D0%B0%D0%BA%D0%BE%D0%B2%20%D0%B8%D0%B7%20%D0%BF%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0%D1%8E%D1%89%D0%B5%D0%B3%D0%BE%20%D0%BD%D0%B0%20%D0%B2%D1%85%D0%BE%D0%B4%20%D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F.%20%D0%94%D0%B0%D0%BD%D0%BD%D0%B0%D1%8F%20%D1%87%D0%B0%D1%81%D1%82%D1%8C%20%D1%81%D0%B5%D1%82%D0%B8%20%D1%8F%D0%B2%D0%BB%D1%8F%D0%B5%D1%82%D1%81%D1%8F%20%D0%B2%D0%B0%D1%80%D0%B8%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D0%B9%20%D0%B8%20%D0%B2%20%D0%B5%D1%91%20%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D1%83%20%D0%BC%D0%BE%D0%B3%D1%83%D1%82%20%D0%B2%D1%85%D0%BE%D0%B4%D0%B8%D1%82%D1%8C%20%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%BD%D0%B5%D0%B9%D1%80%D0%BE%D1%81%D0%B5%D1%82%D0%B8%2C%20%D1%82%D0%B0%D0%BA%D0%B8%D0%B5%20%D0%BA%D0%B0%D0%BA%20ResNet%2C%20VGG%2C%20EfficientNet%20%D0%B8%20%D0%B4%D1%80%D1%83%D0%B3%D0%B8%D0%B5%3B) архитектурами типа ResNet, EfficientNet, Inception,

GoogleNet, etc. (на выбор, выбор обосновать)

4. Снять метрики точности на тестовых данных. Построить матрицу ошибок (confusion

matrix)

5. Сравнить результаты с текущими актуальными моделями.

6. Предложить свои варианты улучшения метрик точности результатов.

**Примечания**:

1. При отсутствии необходимых мощностей gpu. Использовать средства Google

Colab, либо AWS cloud

2. Рекомендуемый фреймворк для использования [Keras](https://keras.io/)+[Tensorflow2.0.](https://www.tensorflow.org/tutorials/quickstart/beginner)

# Приложение для демонстрации
Общие требования:

1) язык интерфейса - English;

2) логирование в файл и консоль (с помощью модуля logging);

3) настроить авторизацию и регистрацию пользователей;

4) наличие формы для заполнения исходных данных (например загрузка изображения и ввод некоторой дополнительной информации);

5) возможность сохранить полученные результаты на диск (например в форматах pdf и json);

6) если целевая задача связана с компьютерным зрением, в приложении также необходимо визуализировать результат на исходном изображении. Полученное изображение отобразить пользователю;

7) данные о зарегистрированных пользователях и результаты проведенных вычислений необходимо сохранять в базу данных;

8) для каждого пользователя хранить количество проведенных вычислений.

Основной вариант использования:

1) пользователь открывает приложение;

2) пользователь проходит авторизацию/регистрацию;

3) после авторизации происходит переход на главную страницу (главное меню). Здесь пользователь может перейти либо в свой аккаунт (там отображается информация о пользователе с возможностью редактирования), либо на страницу с формой для проведения вычислений.

4) пользователь переходит на страницу с формой, загружает исходные данные и запускает вычисление (щелчком по соответствующей кнопке);

5) после завершения вычислений пользователю отображается результат;

6) пользователь сохраняет полученные результаты в виде файла (щелчком по соответствующей кнопке).
### Django web-application
1) рекомендуется использовать встроенную систему авторизации и аутентификации;

2) необходимо продемонстрировать работу с DTL;

3) можно выбрать любую БД, которую поддерживает Django ORM.
### Flask web-application
1) рекомендуется использовать Flask-Login;

2) взаимодействовать с базой данных можно либо с помощью Flask-SQLAlchemy, либо используя другие ORM (например peewee).
### PyQT desktop application
1) взаимодействовать с базой данных можно с помощью ORM (например peewee).

